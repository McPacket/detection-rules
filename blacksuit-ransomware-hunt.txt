./hunt_intel_complete.py   --url https://thedfirreport.com/2024/08/26/blacks2025-10-27 08:51:43,811 - adversary_hunter - INFO - ‚úì Langfuse tracing enabled
2025-10-27 08:51:43,812 - adversary_hunter - INFO - ‚úì Database initialized: ./adversary_hunter.db

================================================================================
ü§ñ ADVERSARY INFRASTRUCTURE HUNTER
================================================================================

üìå Sources: 1
üß† Model: anthropic/claude-sonnet-4.5
üíæ Database: ./adversary_hunter.db

  ‚Ä¢ https://thedfirreport.com/2024/08/26/blacksuit-ransomware/
2025-10-27 08:51:44,096 - adversary_hunter - INFO - Using model: anthropic/claude-sonnet-4.5
/home/user1/adversary_hunting/./hunt_intel_complete.py:1187: DeprecationWarning: `OpenAIModel` was renamed to `OpenAIChatModel` Responses API. Use that unless you're using an OpenAI Chat Completions-compatible API, or require a feature that the Responses A
  model = OpenAIModel(
2025-10-27 08:51:44,149 - adversary_hunter - INFO - ‚úì Hunter initialized
2025-10-27 08:51:44,151 - adversary_hunter - INFO - üì∞ Fetching: https://thedfirreport.com/2024/08/26/blacksuit-ransomware/
2025-10-27 08:51:46,131 - adversary_hunter - INFO - ü§ñ Extracting hunt leads with AI...

================================================================================
üéØ ADVERSARY INFRASTRUCTURE HUNT PLAN
================================================================================

üì∞ Source #1: https://thedfirreport.com/2024/08/26/blacksuit-ransomware/
   Type: url
   Artifact ID: b27a62b582b9fc681efce80bf1a60009

üéØ INTELLIGENCE SUMMARY:
   BlackSuit ransomware intrusion leveraging Cobalt Strike C2 infrastructure with CloudFlare proxying and SystemBC tunneling. Atubdomains) with distinct Cobalt Strike team servers. C2 traffic initially proxied through CloudFlare (104.21.76.140, 172.67.196. (147.78.47.178). SystemBC proxy C2 at 137.220.61.94. Threat actor employed extensive lateral movement via RDP using default Winbeus, and AD enumeration with SharpHound/ADFind. Multiple Cobalt Strike beacons deployed with specific malleable C2 profiles andal security patterns including CloudFlare hiding, AWS pivot, and SystemBC SOCKS5 tunneling. Hunt focus should target Cobalt Stri30818902818100b8783383addbd675...), named pipes, HTTP URI patterns (/shiatzu/v2.41, /hr, /rw), and SystemBC port configurations.

üìç Primary Threat: BlackSuit Ransomware with Cobalt Strike C2 Infrastructure

üè¥ Attribution: BlackSuit Ransomware Operators (formerly Royal Ransomware lineage) (85% confidence)
   Evidence: BlackSuit ransomware deployment with characteristic readme.blacksuit.txt ransom notes, Use of Dogi directory (C:\WiBC SOCKS5 proxy deployment consistent with ransomware-as-a-service affiliate operations

üìä Hunt Leads Extracted: 8
üîç Hunt Queries Generated: 7

--------------------------------------------------------------------------------

üìä Hunt Leads Extracted: 8

üéØ Top Hunt Leads:

  C2 INFRASTRUCTURE:
    ‚Ä¢ domain: svchorst.com
      Confidence: 0.95 | Primary Cobalt Strike C2 domain active throughout intrusion, initially proxied t
      Hunt: Search for active Cobalt Strike team servers using this domain or similar typosquat patterns. Look f
      C2 Framework: Cobalt Strike
    ‚Ä¢ domain: qw.regsvcast.com
      Confidence: 0.95 | Cobalt Strike HTTPS beacon C2 subdomain (one of three: qw/as/zx.regsvcast.com) r
      Hunt: Enumerate all subdomains under regsvcast.com parent domain. Search for the dedicated IP 147.78.47.17
      C2 Framework: Cobalt Strike
    ‚Ä¢ ip: 147.78.47.178
      Confidence: 0.95 | Dedicated Cobalt Strike team server hosting regsvcast.com subdomains (qw/as/zx).
      Hunt: Examine all open ports and services on this IP. Extract JARM fingerprint, SSL certificate details, H
      C2 Framework: Cobalt Strike
    ‚Ä¢ ip: 137.220.61.94
      Confidence: 0.90 | SystemBC SOCKS5 proxy C2 server. Used by socks32.exe malware deployed on file se
      Hunt: Search for SystemBC-specific patterns on this IP including typical ports (4001-4005 common for Syste
      C2 Framework: SystemBC
    ‚Ä¢ ip: 15.197.130.221
      Confidence: 0.90 | AWS-hosted Cobalt Strike team server. The svchorst.com domain switched to this I
      Hunt: Enumerate all services on this AWS IP. Search for other domains resolving to this IP. Look for Cobal
      C2 Framework: Cobalt Strike

  C2 PATTERN:
    ‚Ä¢ http_header: Server:
      Confidence: 0.75 | Cobalt Strike malleable C2 profile with specific HTTP characteristics: User-Agen
      Hunt: Search for Cobalt Strike servers using these specific HTTP URI patterns combined with user-agent str
      C2 Framework: Cobalt Strike

  MALWARE CONFIGURATION:
    ‚Ä¢ ssl_cert: 30819f300d06092a864886f70d010101050003818d0030818902818100b8
      Confidence: 0.85 | Cobalt Strike beacon public key embedded in beacon configurations for both svcho
      Hunt: Search for SSL certificates or network traffic containing this specific public key. This indicates C
      C2 Framework: Cobalt Strike

  NETWORK PATTERN:
    ‚Ä¢ port: 4444
      Confidence: 0.70 | Cobalt Strike SMB named pipe beacon listening on port 4444. SMB beacons used nam
      Hunt: Search for port 4444 combined with SMB/named pipe indicators. Look for Windows systems with unusual
      C2 Framework: Cobalt Strike

================================================================================
ü§ñ AI-GENERATED HUNT QUERIES
================================================================================

  1. [CENSYS] Comprehensive scan of known BlackSuit C2 infrastructure IPs for all active services. Includes Cobalt Strike HTTPS 005). Extracts full service fingerprints including SSL certificates, HTTP headers, and banners for pivoting.
     Query: (ip: 147.78.47.178 OR ip: 15.197.130.221 OR ip: 137.220.61.94) AND services.port: 443,80,4444,4001,4002,4003,4004,40
     Confidence: 95%

  2. [CENSYS] Find all infrastructure associated with BlackSuit C2 domains including historical IP resolutions, SSL certificatesvers.
     Query: services.dns.names: svchorst.com OR services.dns.names: *.regsvcast.com OR parsed.names: svchorst.com OR parsed.name
     Confidence: 92%

  3. [SHODAN] Identify Cobalt Strike HTTPS beacons using characteristic URI patterns from malleable C2 profiles. Combine JARM fiation. Note: JARM value needs to be extracted from live scanning of 147.78.47.178 or 15.197.130.221
     Query: ssl.jarm:{jarm} http.status:200,404 port:443 (http.html:"shiatzu" OR http.html:"unobservedly" OR http.title:"/hr")
     Confidence: 88%

  4. [SHODAN] Find Cobalt Strike servers with identical HTTP response content (malleable C2 profile). HTML hash should be derive typical adversary hosting locations. Note: HTML hash needs to be calculated from live server response.
     Query: http.html_hash:{hash_from_147.78.47.178} ssl:true port:443 -country:US,CA,GB,DE,FR
     Confidence: 80%

  5. [SHODAN] Hunt for AWS-hosted Cobalt Strike infrastructure following observed pattern of svchorst.com switching to AWS IP 15only used for C2. HTTP 404 status often indicates Cobalt Strike default response to non-beacon requests.
     Query: asn:AS16509 country:IE,DE,NL ssl:true port:443 http.status:404 org:"Amazon"
     Confidence: 75%

  6. [SHODAN] Detect potential Cobalt Strike SMB beacons listening on default port 4444. This port is uncommon for legitimate With named pipe indicators (WkSvcPipeMgr) if available through EDR/network logs.
     Query: port:4444 os:windows product:"Microsoft Windows RPC"
     Confidence: 72%

  7. [CENSYS] Detect Cobalt Strike beacons using specific User-Agent strings from observed malleable profiles. These older Chrom SSL on port 443 to focus on HTTPS C2 channels.
     Query: services.http.response.headers.User_Agent: ("Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, likin64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36 Edge/12.246") AND services.port: 443
     Confidence: 68%

================================================================================
üîé ADDITIONAL HUNT QUERIES (AUTO-GENERATED)
================================================================================

üì° Censys Queries:

  1. Servers with certificate pattern: 30819f300d06092a864886f70d010101050003818d0030818902818100b8783383addbd675fb86964aae676bc103f31bb8adae4b4fed45f670943616de985e5dfc034982f3eb8ff643db4433fb59f2a45058eeed09af9881931dd32d999279172b79739f60628e57c311f4234
     Query: services.tls.certificates.leaf_data.subject_dn:"30819f300d06092a864886f70d010101050003818d0030818902818100b8783383ad9761a8f157db0728039c1103f31bb8adae4b4fed45f670943616de985e5dfc034982f3eb8ff643db4433fb59f2a45058eeed09af9881931dd32d999279172b79
     Expected: Low results | FP Risk: Low
